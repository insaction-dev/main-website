{% extends 'base.html' %}
{% load blog %}
{% load rules %}
{% has_perm 'blog' user as can_edit_article %}

{% block title %}
<title>{{object.title}} - Blog INSAction</title>
{% endblock title %} {% block css %}
<style>
    html,
    body {
        margin: 0;
        height: 100%;
    }

    p.flow-text {
        text-align: justify;
        line-break: strict;
    }

    .nowrap {
        white-space: nowrap;
        overflow-x: auto;
    }

    #top-block {
        height: 100vh;
    }

    #top-block>img {
        display: block;
        width: 100%;
        height: 100%;
        object-fit: cover;
        filter: brightness(70%) grayscale(20%);
    }

    #top-block>.container {
        position: absolute;
        bottom: 20%;
        left: 20%;
        width: 70%;
        text-shadow: 0 0 16px black;
    }

    @media (max-width: 650px) {
        #top-block>.container {
            left: 16px;
            width: 90%;
        }
    }
</style>
{% endblock css %} {% block navextend %}
  <div class="nav-wrapper transparent">
      <div class="container nowrap">
          <div class="col s12">
              <a class="breadcrumb" href="{% url 'blog:index' %}">Blogs</a>
              <a class="breadcrumb" href="{% url 'blog:category' object.category.slug %}">{{object.category.name}}</a>
              <a class="breadcrumb active" href="#!">{{object.title}}</a>
          </div>
      </div>
  </div>
{% endblock navextend %}
{% block content %}
<div id="top-block">
    <img src="{{object.image.url}}">
    <div class="container white-text">
        <h1>{{object.title}}</h1>
        <p>
            <span class="grey-text text-lighten-3 flow-text">{{object.author.full_name}} | {{object.created | date}} | Can edit: {{can_edit_article}}</span>
        </p>
    </div>
</div>
{% if can_edit_article %}
<div class="fixed-action-btn">
    <a href="{% url 'blog:article-edit' object.slug %}" class="btn-floating btn-large light-green">
        <i class="large material-icons">mode_edit</i>
    </a>
</div>
{% endif %}
<div class="section">
    <div class="container">
        <p class="flow-text">
            {{object.intro}}
        </p>
        {{edit_perm}}
        <div class="divider"></div>
        <div id="main-article">
            {{object.contents|markdownify}}
        </div>
    </div>
    {% if object.modified != object.created %}
    <div class="container">
        <div class="row">
            <div class="col s10 offset-s1 m6 offset-m2">
                <p class="grey-text darken-1">Modifi√© le {{object.modified | date}}</p>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock content %}
{% block scripts %}
<script>
    $('div#possibly-fixed').css('position', 'absolute').css('z-index', 997).css('width', '100%');
    $('nav.nav-extended.light-green').removeClass('light-green').addClass('transparent z-depth-0');
    $('a.brand-logo').addClass('light-green-text');

    // Adding classes to main article
    $('#main-article>p, #main-article>blockquote').addClass('flow-text');
    $('#main-article>p>img').addClass('right responsive-img fade-in').css('padding', '16px');
</script>
{% endblock scripts %}